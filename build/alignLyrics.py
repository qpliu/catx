#!/usr/bin/python

import sys

if len(sys.argv)!=3:
    sys.stderr.write('Usage: python alignLyrics.py notesfile.notes lyricsfile >alignedLyrics\n')
    sys.stderr.write('    notesfile.notes is file generated by lilypond with \\include "event-listener.ly".\n')
    sys.stderr.write('    lyricsfile is file containing lyrics or -- separated by space and no other junk.\n')
    sys.exit(1)

lyrics = []
with open(sys.argv[2]) as f:
    minusminus = False
    for a in f.read().split():
	if a=='--':
	    minusminus = True
	else:
	    if minusminus:
		a = '-'+a
	    lyrics.append('"'+a+'"')
	    minusminus = False;

with open(sys.argv[1]) as f:
    for line in f:
	l = line.split()
	if l[1]=='rest':
	    print '-'+l[2]
	elif l[1]=='note':
	    if lyrics:
		print lyrics[0]+l[3]
	    else:
		print 'null'+l[3]
	    lyrics = lyrics[1:]
	elif l[1]=='tie':
	    lyrics = ['\\skip']+lyrics

if lyrics:
    print '% Extra lyrics %s'%repr(lyrics)
