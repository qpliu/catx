#!/bin/sh
type pdfinfo >/dev/null 2>&1||exit 0
test -f src/measureToTime||exit 0
out=
comma1=
for a in src-*/out.pdf
do
    if test -f "$a"
    then
	part=`dirname "$a"|cut -c 5-`
	pages=`pdfinfo "$a"|sed -n -e 's/^Pages: *\([0-9]*\)$/\1/p'`
	measures=`tail -n 1 src/measureToTime|sed -n -e 's/^measure=\([0-9]*\).*$/\1/p'`
	out="$out$comma1\"$part\":["
	comma1=,
	comma2=
	p=2
	while test "$p" -lt "$pages"
	do
	    turn=`echo "print (2*$p-1)*$measures/(2*$pages-1)"|python`
	    out="$out$comma2[$turn,1]"
	    comma2=,
	    p=`echo "print $p+1"|python`
	done
	out="$out]"
    fi
done
echo "generatedPageTurns={$out}"
